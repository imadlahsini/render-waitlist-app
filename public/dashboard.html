<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau d'attente des clients</title>
    <style>
        /* Add your styling here */
    </style>
</head>
<body>

<div>
    <h2>Tableau d'attente des clients</h2>

    <input type="text" id="customerName" placeholder="Entrez le nom du client">
    <select id="hourPicker">
        <!-- Add hour options (07 to 19) -->
    </select>
    <select id="minutePicker">
        <!-- Add minute options (00, 15, 30, 45) -->
    </select>
    <select id="visitType">
        <option value="Walkin">Walk-in</option>
        <option value="RDV">RDV</option>
    </select>

    <button onclick="addCustomer()">Ajouter un client</button>
</div>

<div>
    <h3>Liste des clients</h3>
    <ul id="customerList"></ul>
</div>

<script>
    async function fetchCustomers() {
        const response = await fetch('/api/waitlist');
        const customers = await response.json();
        return customers;
    }

    async function displayCustomers() {
        const customers = await fetchCustomers();
        const list = document.getElementById('customerList');
        list.innerHTML = '';

        customers.forEach((customer, index) => {
            const li = document.createElement('li');
            li.innerHTML = `${index + 1}. ${customer.name} (${customer.time}) - ${customer.type}`;
            list.appendChild(li);
        });
    }

    async function addCustomer() {
        const name = document.getElementById('customerName').value;
        const hour = document.getElementById('hourPicker').value;
        const minute = document.getElementById('minutePicker').value;
        const time = `${hour}:${minute}`;
        const type = document.getElementById('visitType').value;

        if (!name || !time) {
            alert('Veuillez entrer toutes les informations');
            return;
        }

        const customer = { name, time, type };

        await fetch('/api/waitlist', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(customer)
        });

        displayCustomers();
    }

    // Fetch and display customers when the page loads
    displayCustomers();
</script>

</body>
</html>
